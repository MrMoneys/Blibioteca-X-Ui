<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Editor Luau Exploit — Luau PRO (Exploit Edition)</title>

    <!-- CodeMirror 5 -> CDN -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/theme/dracula.min.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/addon/hint/show-hint.min.css">

    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/codemirror.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/mode/lua/lua.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/addon/edit/matchbrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/addon/edit/closebrackets.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/addon/hint/show-hint.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/codemirror/5.65.15/addon/hint/anyword-hint.min.js"></script>

    <style>
        :root{--bg:#282a36;--panel:#1e1f29;--accent:#6272a4;--muted:#44475a;--fg:#f8f8f2}
        html, body {height:100%;margin:0;padding:0;font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;background:var(--bg);color:var(--fg)}
        .toolbar{padding:10px;background:var(--panel);display:flex;align-items:center;gap:12px;flex-wrap:wrap}
        .toolbar label{color:var(--fg);font-weight:600}
        #snippet-selector{background:var(--muted);color:var(--fg);border:1px solid var(--accent);border-radius:6px;padding:6px;font-family:inherit}
        .CodeMirror{border-top:1px solid var(--accent);height:calc(100vh - 62px);font-size:15px}
        .CodeMirror-hints{background:var(--bg) !important;color:var(--fg) !important;border:1px solid var(--accent) !important}
        li.CodeMirror-hint-active{background:var(--muted) !important;color:#fff !important}
        .editor-container{flex-grow:1}
        .kbd{background:#111318;border-radius:4px;padding:6px 8px;font-size:13px;color:var(--fg);border:1px solid rgba(255,255,255,0.03)}
        .small{font-size:13px;color:#cfd6ff}
        textarea{width:100%;height:100%}
        @media (max-width:700px){.CodeMirror{font-size:17px;height:calc(100vh - 100px)}}
    </style>
</head>
<body>
    <div class="toolbar">
        <label>⚡ Snippets / Exploit Quick Insert:</label>
        <select id="snippet-selector" onchange="insertSnippet()">
            <option value="">-- Inserir snippet rápido --</option>
            <option value="esp">ESP Básico (Highlight)</option>
            <option value="aimbot">Aimbot Base (Visão)</option>
            <option value="antiKick">Anti-Kick (hookfunc)</option>
            <option value="teleport">Teleport PivotTo (Seguro)</option>
            <option value="remoteSpy">Remote Spy (Hook Remotes)</option>
            <option value="loadstring">Loadstring / getgenv</option>
            <option value="hook">Hook Functions (hookfunction / hookmetamethod)</option>
            <option value="tween">TweenService (Várias versões)</option>
        </select>

        <div class="kbd">Atalhos: <span class="small">Ctrl+Espaço = Autocomplete</span> • <span class="small">Ctrl+1..9 = Inserir Snippet</span></div>
        <div class="small" style="margin-left:auto;">Exploit-focused: <strong>getgenv</strong>, <strong>loadstring</strong>, <strong>firetouchinterest</strong>, <strong>sethiddenproperty</strong></div>
    </div>

    <div class="editor-container">
        <textarea id="luauEditor" autocapitalize="off" autocomplete="off" autocorrect="off" spellcheck="false">-- Editor Luau PRO — Exploit Edition
-- Comece a digitar e pressione Ctrl+Espaço para forçar o autocomplete

-- Exemplos rápidos:
-- getgenv().MyFlag = true
-- loadstring(game:HttpGet("https://..."))()

local Players = game:GetService("Players")

Players.PlayerAdded:Connect(function(p)
	print("Jogador entrou: "..p.Name)
end)
</textarea>
    </div>

    <script>
        // =====================
        // LISTAS DE SUGESTÃO
        // =====================
        const luauKeywords = [
            "and","break","do","else","elseif","end","false","for","function",
            "if","in","local","nil","not","or","repeat","return","then",
            "true","until","while","continue"
        ];

        const robloxGlobals = [
            "game","workspace","script","plugin","wait","print","warn","error",
            "Instance","Vector3","Vector2","CFrame","Color3","BrickColor","Enum",
            "math","table","string","os","debug","coroutine","typeof","tick"
        ];

        const robloxServices = [
            "Players","TweenService","ReplicatedStorage","ServerScriptService","ServerStorage",
            "StarterPlayer","StarterGui","StarterPack","UserInputService","ContextActionService",
            "Debris","Lighting","SoundService","MarketplaceService","TeleportService","DataStoreService"
        ];

        const robloxInstanceTypes = [
            "Part","MeshPart","Model","Folder","ScreenGui","TextLabel","TextButton","Frame",
            "RemoteEvent","RemoteFunction","BindableEvent","BindableFunction","Tool","Humanoid","Head"
        ];

        const robloxProperties = [
            "Name","Parent","ClassName","Archivable","Position","Size","CFrame","Orientation",
            "Velocity","Anchored","CanCollide","Transparency","BrickColor","Color","Material",
            "Reflectance","Locked","Value","Enabled","Text","TextColor3","TextSize","Visible"
        ];

        const robloxMethods = [
            "FindFirstChild","WaitForChild","FindFirstChildOfClass","GetChildren","GetDescendants",
            "IsA","Clone","Destroy","ClearAllChildren","FireServer()","InvokeServer()","Connect","Disconnect","Wait","Play","Stop","Create"
        ];

        const robloxEvents = [
            "Touched","TouchEnded","ChildAdded","ChildRemoved","AncestryChanged","Changed",
            "PlayerAdded","PlayerRemoving","OnServerEvent","OnClientEvent","MouseButton1Click","InputBegan","InputEnded"
        ];

        // Funções / helpers usadas em exploits (comuns em executors)
        const exploitFunctions = [
            "getgenv","shared","setreadonly","hookfunction","hookmetamethod","checkcaller",
            "getfenv","setfenv","getrawmetatable","setrawmetatable","getupvalue","setupvalue",
            "getconnections","firetouchinterest","fireproximityprompt","sethiddenproperty","getsenv",
            "writefile","readfile","isfile","delfile","isfolder","makefolder","HttpGet","HttpPost",
            "loadstring","syn.request","http_request","request","LocalPlayer","LowerTorso","UpperTorso",
            "CanCollide"
        ];

        // Mescla tudo para fallback
        const allSuggestions = [...new Set([
            ...luauKeywords, ...robloxGlobals, ...robloxServices, ...robloxInstanceTypes,
            ...robloxProperties, ...robloxMethods, ...robloxEvents, ...exploitFunctions
        ])].sort();

        // =====================
        // INICIALIZAÇÃO DO EDITOR
        // =====================
        const editor = CodeMirror.fromTextArea(document.getElementById("luauEditor"), {
            lineNumbers: true,
            mode: "lua",
            theme: "dracula",
            matchBrackets: true,
            autoCloseBrackets: true,
            indentUnit: 4,
            extraKeys: {
                "Ctrl-Space": function(cm){ cm.showHint({hint: CodeMirror.hint.luau, completeSingle: false}); },
                "Ctrl-1": function(cm){ insertSnippetByKey('esp'); },
                "Ctrl-2": function(cm){ insertSnippetByKey('aimbot'); },
                "Ctrl-3": function(cm){ insertSnippetByKey('antiKick'); },
                "Ctrl-4": function(cm){ insertSnippetByKey('teleport'); },
                "Ctrl-5": function(cm){ insertSnippetByKey('remoteSpy'); },
                "Ctrl-6": function(cm){ insertSnippetByKey('loadstring'); },
                "Ctrl-7": function(cm){ insertSnippetByKey('hook'); },
                "Ctrl-8": function(cm){ insertSnippetByKey('tween'); }
            }
        });

        // =====================
        // HINT CUSTOMIZADO (LUAU + CONTEXTO EXPLOIT)
        // =====================
        CodeMirror.registerHelper('hint', 'luau', function(cm, options){
            const cur = cm.getCursor();
            const token = cm.getTokenAt(cur);
            const start = token.start;
            const end = cur.ch;
            const curWord = token.string.slice(0, end - start);

            // Lista base: combinar suggestions filter por prefix
            const baseList = allSuggestions.filter(w => w.toLowerCase().startsWith(curWord.toLowerCase()));

            // Contextual rules
            // Se o usuário está digitando game:GetService("... -> sugestões de serviços
            const lineBefore = cm.getLine(cur.line).slice(0, cur.ch);
            const serviceMatch = lineBefore.match(/game\s*:\s*GetService\s*\(\s*[\"\']([^\"\']*)$/);
            if (serviceMatch) {
                return {list: robloxServices.filter(s => s.toLowerCase().startsWith(serviceMatch[1].toLowerCase())), from: CodeMirror.Pos(cur.line, token.start), to: CodeMirror.Pos(cur.line, token.end)};
            }

            // Se está escrevendo Instance.new("... -> sugerir tipos de instância
            const instMatch = lineBefore.match(/Instance.new\(\s*[\"\']([^\"\']*)$/);
            if (instMatch) {
                return {list: robloxInstanceTypes.filter(s => s.toLowerCase().startsWith(instMatch[1].toLowerCase())), from: CodeMirror.Pos(cur.line, token.start), to: CodeMirror.Pos(cur.line, token.end)};
            }

            // Se começa com "fire" sugerir funções de firetouch/fireproximity
            if (/^fire/i.test(curWord)) {
                const fireList = exploitFunctions.filter(f => /^fire/i.test(f));
                return {list: fireList.length ? fireList : baseList, from: CodeMirror.Pos(cur.line, token.start), to: CodeMirror.Pos(cur.line, token.end)};
            }

            // Se começa com getgenv / loadstring -> sugerir explit funcs
            if (/^getgenv|^loadstring|^hook/i.test(curWord)) {
                const ex = exploitFunctions.filter(f => f.toLowerCase().startsWith(curWord.toLowerCase()));
                return {list: ex.length ? ex : baseList, from: CodeMirror.Pos(cur.line, token.start), to: CodeMirror.Pos(cur.line, token.end)};
            }

            // Fallback: sugestões base + palavras do documento
            const anyword = CodeMirror.hint.anyword(cm) || {list: []};
            const combined = [...new Set([...baseList, ...anyword.list])].sort();
            return {list: combined, from: CodeMirror.Pos(cur.line, token.start), to: CodeMirror.Pos(cur.line, token.end)};
        });

        // Mostrar hint automaticamente ao digitar (apenas para tokens com >=2 chars)
        editor.on('keyup', function(cm, event){
            if (cm.state.completionActive) return;
            if (!event || !event.key) return;
            const key = event.key;
            if (key.length === 1 && /[a-zA-Z_]/.test(key)){
                const cur = cm.getCursor();
                const token = cm.getTokenAt(cur);
                if (token.string && token.string.length >= 2) {
                    cm.showHint({hint: CodeMirror.hint.luau, completeSingle:false});
                }
            }
        });

        // =====================
        // SNIPPETS ESPECIALIZADOS (Exploit-focused)
        // =====================
        const snippets = {
            esp: `\n-- Snippet: ESP Básico usando Highlight\nlocal Players = game:GetService(\"Players\")\nlocal RunService = game:GetService(\"RunService\")\n\nfor _, p in pairs(Players:GetPlayers()) do\n\tif p.Character and p.Character:FindFirstChild(\"HumanoidRootPart\") then\n\t\tlocal hrp = p.Character.HumanoidRootPart\n\t\tlocal highlight = Instance.new(\"Highlight\")\n\t\thighlight.Adornee = p.Character\n\t\thighlight.Parent = workspace\n\tend\nend\n\n-- Atualizar dinamicamente pode ser necessário dependendo do jogo\n`,

            aimbot: `\n-- Snippet: Aimbot base (exemplo simplificado — ajuste para seu executor)\nlocal Players = game:GetService(\"Players\")\nlocal LocalPlayer = Players.LocalPlayer\nlocal mouse = LocalPlayer:GetMouse()\nlocal enabled = true\nlocal targetKey = Enum.UserInputType.MouseButton1 -- Exemplo de ativação\n\nlocal function getClosestEnemy()\n\tlocal closest, dist = nil, math.huge\n\tfor _, p in pairs(Players:GetPlayers()) do\n\t\tif p ~= LocalPlayer and p.Character and p.Character:FindFirstChild(\"HumanoidRootPart\") then\n\t\t\tlocal pos = workspace.CurrentCamera:WorldToViewportPoint(p.Character.HumanoidRootPart.Position)\n\t\t\tlocal d = (Vector2.new(pos.X,pos.Y) - Vector2.new(mouse.X, mouse.Y)).magnitude\n\t\t\tif d < dist then dist = d; closest = p end\n\t\tend\n\tend\n\treturn closest\nend\n\n-- uso: chame getClosestEnemy() e aponte a câmera para o alvo (ex: set camera CFrame)
`,

            antiKick: `\n-- Snippet: Anti-Kick usando hookfunction (exemplo comum em executors)\nif hookfunction then\n\tlocal oldKick = hookfunction or function() end\t-- cuidado, alguns executors têm APIs diferentes\nend\n\n-- Alternativa: monitorar RemoteEvents e filtrar payloads suspeitos\n`,

            teleport: `\n-- Snippet: Teleport seguro usando PivotTo\nlocal player = game.Players.LocalPlayer\nlocal char = player.Character or player.CharacterAdded:Wait()\nlocal root = char:WaitForChild(\"HumanoidRootPart\")\n\nlocal function teleportTo(pos)\n\troot:PivotTo(CFrame.new(pos))\nend\n\n-- teleportTo(Vector3.new(0,50,0))\n`,

            remoteSpy: `\n-- Snippet: Remote Spy (hook Remotes)\nlocal ReplicatedStorage = game:GetService(\"ReplicatedStorage\")\nlocal rs = ReplicatedStorage:GetDescendants()\nfor _, v in pairs(rs) do\n\tif v:IsA(\"RemoteEvent\") then\n\t\tv.OnClientEvent:Connect(function(...)\n\t\t\tprint('[RemoteEvent]', v:GetFullName(), ...)
\t\tend)
\tend
end\n\n-- Para Remotes do servidor: hook metatable/Invoke/Fire se necessário
`,

            loadstring: `\n-- Snippet: loadstring / getgenv usage\nif getgenv then getgenv().MyFlag = true end\nlocal content = (syn and syn.request and syn.request({Url = 'https://example.com/script.lua', Method='GET'}).Body) or (game:HttpGet('https://example.com/script.lua'))\nif loadstring then\n\tloadstring(content)()\nelse\t-- fallback para executores sem loadstring\n\tassert(false, 'loadstring não disponível')\nend\n`,

            hook: `\n-- Snippet: hookfunction / hookmetamethod exemplo\nif hookfunction then\n\tlocal old = hookfunction(someFunction, function(...)\n\t\t-- intercept\n\t\treturn old(...)\n\tend)
end\n\n-- hookmetamethod exemplo (checar executor se possui hookmetamethod)
`,

            tween: `\n-- Snippet: TweenService (Vários perfis)\nlocal TweenService = game:GetService(\"TweenService\")\nlocal part = workspace:FindFirstChild(\"Part\") or Instance.new('Part', workspace)\nlocal info = TweenInfo.new(1, Enum.EasingStyle.Linear)
local tween = TweenService:Create(part, info, {Position = part.Position + Vector3.new(0,20,0)})
tween:Play()
`,

            noclip: `\n-- Snippet: Noclip \ngame:service'Players'.LocalPlayer
_G.Noclip = game:service'RunService'.Stepped:Connect(function()
lp.Character.Head.CanCollide = false
lp.Character.LowerTorso.CanCollide = false
lp.Character.UpperTorso.CanCollide = false
lp.Character.HumanoidRootPart.CanCollide = false
if lp.Character:FindFirstChild'Badge' then
lp.Character.Badge.CanCollide = false
end
end)
end
`

        };

        function insertSnippet(){
            const selector = document.getElementById('snippet-selector');
            const type = selector.value;
            if (!type) return;
            editor.replaceSelection(snippets[type] || '');
            selector.selectedIndex = 0;
            editor.focus();
        }

        function insertSnippetByKey(key){
            // mapear chaves para snippets
            const map = {
                esp: 'esp', aimbot: 'aimbot', antiKick: 'antiKick', teleport: 'teleport', remoteSpy: 'remoteSpy', loadstring: 'loadstring', hook: 'hook', tween: 'tween'
            };
            const name = map[key] || key;
            if (snippets[name]){
                editor.replaceSelection(snippets[name]);
                editor.focus();
            }
        }

        // =====================
        // MELHORIAS: salvar/recuperar localStorage (session)
        // =====================
        const STORAGE_KEY = 'luau_exploit_editor_content_v1';
        // carregar
        const saved = localStorage.getItem(STORAGE_KEY);
        if (saved) editor.setValue(saved);
        // autosave a cada 2s (debounced)
        let saveTimer = null;
        editor.on('change', function(){
            if (saveTimer) clearTimeout(saveTimer);
            saveTimer = setTimeout(()=>{
                localStorage.setItem(STORAGE_KEY, editor.getValue());
            }, 1500);
        });

        // =====================
        // FUNÇÃO DE EXPORTAR (CTRL+S não sobrescreve comportamento do navegador) — botão futuro
        // =====================
        // Exemplo rápido de exportar -> copia para clipboard
        function copyToClipboard(){
            const text = editor.getValue();
            navigator.clipboard.writeText(text).then(()=>{ alert('Conteúdo copiado para a área de transferência'); }, (e)=>{ alert('Falha ao copiar: '+e); });
        }

        // =====================
        // Mensagem de pronto no console (debug)
        // =====================
        console.log('Luau Exploit Editor carregado — autocomplete e snippets prontos.');
    </script>
</body>
</html>
